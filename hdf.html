<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>–•–î–§</title>
<link rel="icon" href="favicon.ico" sizes="any">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/svg+xml" href="favicon.svg">
<link rel="manifest" href="manifest-hdf.json">
<meta name="theme-color" content="#111111">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="wrap">
<div id="mainView">
 <div class="card">
 <button id="refreshBtn" title="–û–±–Ω–æ–≤–∏—Ç—å">‚Üª</button>
 <div class="badge">–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</div>
 <h2>–°–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR –∑–∞–∫–∞–∑–∞</h2>
 <div class="video-wrap">
 <video id="video" autoplay playsinline muted></video>
 <div id="scanOverlay" class="scan-overlay hidden"></div>
 </div>
 <canvas id="canvas" style="display:none;"></canvas>
 <div id="msg" class="small"></div>
 <button id="startCam">–°–ö–ê–ù–ò–†–û–í–ê–¢–¨</button>
 </div>

 <div class="card">
 <div class="grid">
 <input id="order" placeholder="QR / –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞" autofocus />
 <input id="worker" placeholder="–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞" />
 </div>
 </div>

 <div class="card">
 <h3 id="stageTitle">–≠—Ç–∞–ø:</h3>
 <div id="stageButtons">
 <button data-stage="hdf">–•–î–§</button>
 </div>
 <div id="status">–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ</div>
 </div>

 <div class="card">
 <button id="openReports">–û–¢–ß–Å–¢–´</button>
 </div>
</div>

<div id="reportsView" class="hidden">
 <div class="card">
 <div class="badge">–û—Ç—á—ë—Ç—ã</div>
 <div class="filters">
 <button data-filter="day">–ó–∞ –¥–µ–Ω—å</button>
 <button data-filter="week">–ó–∞ –Ω–µ–¥–µ–ª—é</button>
 <button data-filter="month">–ó–∞ –º–µ—Å—è—Ü</button>
 <button data-filter="all">–í—Å–µ</button>
 </div>
 <div class="tools">
 <input id="searchInput" placeholder="–ü–æ–∏—Å–∫..." />
 <select id="sortSelect">
 <option value="time_desc">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –≤—Ä–µ–º—è ‚Üì</option>
 <option value="time_asc">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –≤—Ä–µ–º—è ‚Üë</option>
 <option value="date_desc">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –¥–∞—Ç–∞ ‚Üì</option>
 <option value="date_asc">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –¥–∞—Ç–∞ ‚Üë</option>
 <option value="order_asc">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –∑–∞–∫–∞–∑ ‚Üë</option>
 <option value="order_desc">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –∑–∞–∫–∞–∑ ‚Üì</option>
 <option value="db_asc">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: —Ç–∞–±–ª–∏—Ü–∞ ‚Üë</option>
 <option value="db_desc">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: —Ç–∞–±–ª–∏—Ü–∞ ‚Üì</option>
 </select>
 </div>
 <div class="tools" style="margin-top:8px;">
 <input type="date" id="statsDate">
 <select id="statsStage">
 <option value="all">–≠—Ç–∞–ø: –≤—Å–µ</option>
 <option value="pila">–ü–∏–ª–∞</option>
 <option value="hdf">–•–î–§</option>
 <option value="kromka">–ö—Ä–æ–º–∫–∞</option>
 <option value="prisadka">–ü—Ä–∏—Å–∞–¥–∫–∞</option>
 <option value="upakovka">–£–ø–∞–∫–æ–≤–∫–∞</option>
 </select>
 <button id="statsBtn" style="width:auto;font-size:12px;padding:6px8px;border-radius:10px;">–ü–æ—Å—á–∏—Ç–∞—Ç—å</button>
 <span id="statsResult" class="small" style="margin-left:6px;"></span>
 </div>
 <div class="tools" style="margin-top:8px;">
 <input type="date" id="pdfFrom">
 <input type="date" id="pdfTo">
 <button id="exportPdf" style="width:auto;font-size:12px;padding:6px8px;border-radius:10px;">–≠–∫—Å–ø–æ—Ä—Ç PDF</button>
 </div>
 <div id="reportsStatus" class="small" style="margin-top:8px;">–ù–∞–π–¥–µ–Ω–æ:0</div>
 <div style="overflow:auto;margin-top:10px;">
 <table class="table" id="reportsTable">
 <thead>
 <tr>
 <th>–ó–∞–∫–∞–∑</th><th>–î–∞—Ç–∞</th><th>–í—Ä–µ–º—è</th><th>–≠—Ç–∞–ø</th><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th><th>–¢–∞–±–ª–∏—Ü–∞</th><th class="row-actions">–î–µ–π—Å—Ç–≤–∏—è</th>
 </tr>
 </thead>
 <tbody></tbody>
 </table>
 </div>
 <div id="pager" class="pager"></div>
 <button id="openPhotoStore">–ê–†–•–ò–í –§–û–¢–û</button>
 <button id="editReports">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
 <button id="closeReports" style="margin-top:8px;">–ù–∞–∑–∞–¥</button>
 </div>
</div>
</div>

<div id="printArea"></div>

<button id="chatBtn" title="–ß–∞—Ç" onclick="(function(){
 const n = (document.getElementById('worker')?.value || localStorage.getItem('workerName') || '').trim();
 window.open('chat.html?name='+encodeURIComponent(n),'_blank');
})()">üí¨</button>

<script src="https://unpkg.com/jsqr/dist/jsQR.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.5.29/dist/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="app.js" defer></script>
</body>
</html>
